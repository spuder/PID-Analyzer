language: generic

matrix:
  include:
    - os: osx
      osx_image: xcode9.3 # https://github.com/pypa/pip/issues/5226#issuecomment-384815600

install:
  - python --version
  - brew reinstall python
  - sudo pip install --upgrade pip # https://github.com/pypa/pip/issues/5226#issuecomment-384815600
env:
  global:
    - BLACKBOX_VERSION="0.4.3"
script:
  - python --version
  - pip --version
  # - pip install tornado
  # - sudo -H pip install nose
  # - python setup.py install --user
  - pip install PyInstaller --user
  - ls
  - pyinstaller --user --version
  # - wget https://github.com/cleanflight/blackbox-tools/releases/download/v$BLACKBOX_VERSION/blackbox-tools-$BLACKBOX_VERSION-macosx.tar.gz
  # - tar -xvf blackbox-tools-0.4.3-macosx.tar.gz
  # https://stackoverflow.com/questions/47318119/no-module-named-pandas-libs-tslibs-timedeltas-in-pyinstaller
  - |
    if [ ! -e '/Library/Python/2.7/site-packages/PyInstaller/hooks/hook-pandas.py' ]; then
      echo "Writing out hooks-pandas.py"
      echo "hiddenimports = ['pandas._libs.tslibs.np_datetime','pandas._libs.tslibs.nattype','pandas._libs.skiplist']" | sudo tee /Library/Python/2.7/site-packages/PyInstaller/hooks/hook-pandas.py
    else
      echo "hook-pandas.py already exists"
    fi
  - PyInstaller --windowed PID-Analyzer.py -y --clean
  # lldb ./dist/PID-Analyzer.app
  # process launch
